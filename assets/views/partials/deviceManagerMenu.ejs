<div class="flex min-h-screen">
    <!-- Mobile Menu Button -->
    <div class="md:hidden fixed top-0 left-0 z-50 w-full bg-gray-800 px-4 py-3 border-b border-gray-700">
        <button id="mobileMenuButton" class="p-2 text-gray-400 hover:text-white rounded-lg">
            <i class="fa-solid fa-bars text-lg"></i>
        </button>
    </div>

    <!-- Sidebar Navigation -->
    <div id="sidebar" class="fixed md:sticky md:top-0 inset-y-0 left-0 transform -translate-x-full md:translate-x-0 w-64 bg-gray-800 p-4 border-r border-gray-700 transition-all duration-300 ease-in-out z-40 h-screen overflow-y-auto shadow-lg">
        <nav class="space-y-2 h-full overflow-y-auto py-14 md:py-2">
            <a href="<%= baseURL %>/gps" class="flex items-center space-x-3 px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 <% if (page==='gps') { %> bg-gray-700 text-green-400 shadow-inner <% } else { %> text-gray-400 hover:bg-gray-700 hover:text-gray-200 <% } %>">
                <i class="fa-solid fa-location-dot"></i>
                <span>GPS</span>
            </a>
            <a href="<%= baseURL %>/microphone" class="flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-medium <% if (page==='microphone') { %> bg-gray-700 text-green-400 <% } else { %> text-gray-400 hover:bg-gray-700 <% } %>">
                <i class="fa-solid fa-microphone"></i>
                <span>Microphone</span>
            </a>
            <a href="<%= baseURL %>/contacts" class="flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-medium <% if (page==='contacts') { %> bg-gray-700 text-green-400 <% } else { %> text-gray-400 hover:bg-gray-700 <% } %>">
                <i class="fa-solid fa-address-book"></i>
                <span>Contacts</span>
            </a>
            <a href="<%= baseURL %>/calls" class="flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-medium <% if (page==='calls') { %> bg-gray-700 text-green-400 <% } else { %> text-gray-400 hover:bg-gray-700 <% } %>">
                <i class="fa-solid fa-phone"></i>
                <span>Call Log</span>
            </a>
            <a href="<%= baseURL %>/clipboard" class="flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-medium <% if (page==='clipboard') { %> bg-gray-700 text-green-400 <% } else { %> text-gray-400 hover:bg-gray-700 <% } %>">
                <i class="fa-solid fa-clipboard"></i>
                <span>Clipboard Log</span>
            </a>
            <a href="<%= baseURL %>/notifications" class="flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-medium <% if (page==='notifications') { %> bg-gray-700 text-green-400 <% } else { %> text-gray-400 hover:bg-gray-700 <% } %>">
                <i class="fa-solid fa-circle-exclamation"></i>
                <span>Notification Log</span>
            </a>
            <a href="<%= baseURL %>/sms" class="flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-medium <% if (page==='sms') { %> bg-gray-700 text-green-400 <% } else { %> text-gray-400 hover:bg-gray-700 <% } %>">
                <i class="fa-solid fa-comment-dots"></i>
                <span>SMS Manager</span>
            </a>
            <a href="<%= baseURL %>/wifi" class="flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-medium <% if (page==='wifi') { %> bg-gray-700 text-green-400 <% } else { %> text-gray-400 hover:bg-gray-700 <% } %>">
                <i class="fa-solid fa-wifi"></i>
                <span>WiFi Manager</span>
            </a>
            <a href="<%= baseURL %>/apps" class="flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-medium <% if (page==='apps') { %> bg-gray-700 text-green-400 <% } else { %> text-gray-400 hover:bg-gray-700 <% } %>">
                <i class="fa-brands fa-google-play"></i>
                <span>Installed Apps</span>
            </a>
            <a href="<%= baseURL %>/permissions" class="flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-medium <% if (page==='permissions') { %> bg-gray-700 text-green-400 <% } else { %> text-gray-400 hover:bg-gray-700 <% } %>">
                <i class="icon tasks"></i>
                <span>Allowed Permissions</span>
            </a>
            <a href="<%= baseURL %>/files" class="flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-medium <% if (page==='files') { %> bg-gray-700 text-green-400 <% } else { %> text-gray-400 hover:bg-gray-700 <% } %>">
                <i class="fa-solid fa-folder-open"></i>
                <span>File Explorer</span>
            </a>
            <a href="<%= baseURL %>/downloads" class="flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-medium <% if (page==='downloads') { %> bg-gray-700 text-green-400 <% } else { %> text-gray-400 hover:bg-gray-700 <% } %>">
                <i class="fa-solid fa-download"></i>
                <span>Downloads</span>
            </a>
        </nav>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const menuButton = document.getElementById('mobileMenuButton');
        const sidebar = document.getElementById('sidebar');
        const content = document.querySelector('.content');

        function toggleMenu(shouldOpen) {
            const isOpen = !sidebar.classList.contains('-translate-x-full');
            if(typeof shouldOpen === 'boolean' && shouldOpen === isOpen) return;
            
            sidebar.classList.toggle('-translate-x-full');
            if(window.innerWidth < 768) {
                document.body.style.overflow = isOpen ? 'auto' : 'hidden';
            }
        }

        if(menuButton && sidebar) {
            menuButton.addEventListener('click', function(e) {
                e.stopPropagation();
                toggleMenu();
            });

            document.addEventListener('click', function(e) {
                if(window.innerWidth < 768 && !sidebar.contains(e.target) && !menuButton.contains(e.target)) {
                    toggleMenu(false);
                }
            });

            document.addEventListener('keydown', (e) => {
                if(e.key === 'Escape' && window.innerWidth < 768) {
                    toggleMenu(false);
                }
            });

            let touchStartX = 0;
            let touchEndX = 0;

            document.addEventListener('touchstart', (e) => {
                touchStartX = e.changedTouches[0].screenX;
            }, false);

            document.addEventListener('touchend', (e) => {
                touchEndX = e.changedTouches[0].screenX;
                const swipeDistance = touchEndX - touchStartX;

                if(Math.abs(swipeDistance) > 50) {
                    if(swipeDistance > 0) {
                        toggleMenu(true);
                    } else {
                        toggleMenu(false);
                    }
                }
            }, false);

            window.addEventListener('resize', function() {
                if(window.innerWidth >= 768) {
                    toggleMenu(true);
                    document.body.style.overflow = 'auto';
                } else {
                    toggleMenu(false);
                }
            });

            if(window.innerWidth >= 768) {
                toggleMenu(true);
            }
        }
    });
    </script>
</div>